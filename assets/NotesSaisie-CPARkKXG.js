import{m as v,c as b,w as E,a as l,b as e,k as p,J as c,F as x,h as g,f as w,I as C,t as d,x as B,o}from"./index-C5nwF8dZ.js";import{u as D}from"./school-CTfOjOI2.js";const M={class:"space-y-4"},T={class:"grid gap-3 md:grid-cols-2"},F={class:"rounded-xl border p-4 space-y-3 bg-white dark:bg-slate-900 dark:border-slate-800"},P={class:"grid gap-2 sm:grid-cols-2"},j={class:"block"},A=["value"],J={class:"block"},L=["disabled"],q=["value"],z={class:"grid gap-2 sm:grid-cols-3"},G={class:"block"},H=["value"],K={class:"block sm:col-span-2"},O=["disabled"],Q=["value"],R={class:"grid gap-2 sm:grid-cols-3"},W={class:"block"},X={class:"block"},Y={class:"block"},Z=["disabled"],$={class:"rounded-xl border p-4 bg-white dark:bg-slate-900 dark:border-slate-800"},ee={class:"font-semibold mb-2"},se={class:"overflow-x-auto"},te={class:"min-w-full text-sm"},le={class:"p-3"},oe={class:"p-3"},ae={class:"p-3"},de={class:"p-3"},ue={key:0},ve={__name:"NotesSaisie",setup(ne){const a=D(),r=v(0),i=v(0),m=v(0),n=v(a.periodes.find(u=>u.active)?.id??a.periodes[0]?.id??0),k=v("Devoir"),f=v(1),y=v(10),I=b(()=>a.students.filter(u=>u.classeId===r.value)),V=b(()=>a.cours.filter(u=>u.classeId===r.value&&(!n.value||u.periodeId===n.value))),N=b(()=>a.getStudent(i.value)),h=b(()=>a.getPeriode(n.value));E(r,()=>{i.value=0,m.value=0});const _=b(()=>i.value&&n.value?a.getEvaluations(i.value,n.value):[]),S=b(()=>!!(r.value&&i.value&&m.value&&n.value&&f.value>0));function U(){const u=a.coursById[m.value];u&&a.upsertEvaluation({eleveId:Number(i.value),periodeId:Number(n.value),matiere:u.matiere,type:k.value,coef:Number(f.value),note:Number(y.value),obs:""})}return(u,s)=>(o(),l("section",M,[s[20]||(s[20]=e("header",null,[e("h1",{class:"text-xl font-semibold"},"Saisie des notes"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Créer / mettre à jour une évaluation d’un élève")],-1)),e("div",T,[e("div",F,[e("div",P,[e("label",j,[s[8]||(s[8]=e("span",{class:"text-xs text-slate-500"},"Classe",-1)),p(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>r.value=t),class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900"},[s[7]||(s[7]=e("option",{value:0,disabled:""},"— Choisir —",-1)),(o(!0),l(x,null,g(w(a).classesView,t=>(o(),l("option",{key:t.id,value:t.id},d(t.libelle),9,A))),128))],512),[[c,r.value,void 0,{number:!0}]])]),e("label",J,[s[10]||(s[10]=e("span",{class:"text-xs text-slate-500"},"Élève",-1)),p(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900",disabled:!r.value},[s[9]||(s[9]=e("option",{value:0,disabled:""},"— Choisir —",-1)),(o(!0),l(x,null,g(I.value,t=>(o(),l("option",{key:t.id,value:t.id},d(t.nom),9,q))),128))],8,L),[[c,i.value,void 0,{number:!0}]])])]),e("div",z,[e("label",G,[s[11]||(s[11]=e("span",{class:"text-xs text-slate-500"},"Période",-1)),p(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>n.value=t),class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900"},[(o(!0),l(x,null,g(w(a).periodes,t=>(o(),l("option",{key:t.id,value:t.id},d(t.label),9,H))),128))],512),[[c,n.value,void 0,{number:!0}]])]),e("label",K,[s[13]||(s[13]=e("span",{class:"text-xs text-slate-500"},"Cours (matière)",-1)),p(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>m.value=t),class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900",disabled:!r.value},[s[12]||(s[12]=e("option",{value:0,disabled:""},"— Choisir —",-1)),(o(!0),l(x,null,g(V.value,t=>(o(),l("option",{key:t.id,value:t.id},d(t.matiere)+" — "+d(t.intitule),9,Q))),128))],8,O),[[c,m.value,void 0,{number:!0}]])])]),e("div",R,[e("label",W,[s[15]||(s[15]=e("span",{class:"text-xs text-slate-500"},"Type",-1)),p(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>k.value=t),class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900"},[...s[14]||(s[14]=[e("option",null,"Devoir",-1),e("option",null,"Interro",-1),e("option",null,"Examen",-1)])],512),[[c,k.value]])]),e("label",X,[s[16]||(s[16]=e("span",{class:"text-xs text-slate-500"},"Coef",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>f.value=t),type:"number",min:"1",class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900"},null,512),[[C,f.value,void 0,{number:!0}]])]),e("label",Y,[s[17]||(s[17]=e("span",{class:"text-xs text-slate-500"},"Note (/20)",-1)),p(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>y.value=t),type:"number",step:"0.5",min:"0",max:"20",class:"mt-1 w-full px-3 py-2 rounded border dark:bg-slate-900"},null,512),[[C,y.value,void 0,{number:!0}]])])]),e("button",{class:"w-full sm:w-auto px-4 py-2 rounded bg-indigo-600 text-white",disabled:!S.value,onClick:U}," Enregistrer ",8,Z)]),e("div",$,[e("h3",ee,"Évaluations ("+d(N.value?.nom||"—")+", "+d(h.value?.label||"—")+")",1),e("div",se,[e("table",te,[s[19]||(s[19]=e("thead",{class:"bg-slate-50 dark:bg-slate-900/50"},[e("tr",{class:"text-left"},[e("th",{class:"p-3"},"Matière"),e("th",{class:"p-3"},"Type"),e("th",{class:"p-3"},"Coef"),e("th",{class:"p-3"},"Note")])],-1)),e("tbody",null,[(o(!0),l(x,null,g(_.value,t=>(o(),l("tr",{key:t.id||t.matiere+t.type+t.coef+t.note,class:"border-t dark:border-slate-800"},[e("td",le,d(t.matiere),1),e("td",oe,d(t.type),1),e("td",ae,d(t.coef),1),e("td",de,d(t.note),1)]))),128)),_.value.length?B("",!0):(o(),l("tr",ue,[...s[18]||(s[18]=[e("td",{colspan:"4",class:"p-4 text-center text-slate-500"},"Aucune note",-1)])]))])])])])])]))}};export{ve as default};
