import{u as F,c as C,R as x,r as U,w as W,a as c,o as d,b as t,d as v,e as g,f as N,g as L,F as z,h as I,t as y,i as q,n as S,T as O,j as Y,k as J,l as E,v as Q,m as B,p as G,q as X,s as j,x as K,y as R,z as H,A as Z,B as ee,C as te,D as oe,E as se,G as re,H as ne}from"./index-C5nwF8dZ.js";import{u as le}from"./school-CTfOjOI2.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"h-full flex flex-col"},ie={class:"px-4 h-16 flex items-center border-b border-gray-200 dark:border-gray-800"},de={class:"flex-1 overflow-y-auto py-4 px-3"},ue={class:"sr-only"},ce=["onClick","aria-expanded","aria-controls"],fe={class:"inline-flex items-center gap-3"},pe=["innerHTML"],ve=["id"],ge={class:"inline-flex items-center gap-3"},me=["innerHTML"],he={__name:"Sidebar",emits:["navigate"],setup(m){const i=Y(),a=F(),b=C(()=>a.role??a.user?.role??null),s=e=>typeof e=="string"?e.trim():e&&typeof e=="object"?(e.code??e.value??e.key??String(e)).trim():String(e??"").trim(),h=(e,o)=>{if(!e||!Array.isArray(e)||e.length===0)return!0;if(!o)return!1;const p=s(o);return e.map(s).includes(p)},u=[{title:"Admin général",items:[{key:"saas-admin",label:"Administration globale",icon:"shield",roles:[x.ADMIN_GENERALE],children:[{to:"/admin/ecoles",prefix:"/admin/ecoles",label:"Écoles"},{to:"/admin/utilisateurs",prefix:"/admin/utilisateurs",label:"Utilisateurs"}]}]},{title:"Admin école",items:[{key:"ecole-structure",label:"Structure académique",icon:"layers",roles:[x.ADMIN_GENERALE,x.ADMIN_ECOLE],children:[{to:"/classes",prefix:"/classes",label:"Classes"},{to:"/filieres",prefix:"/filieres",label:"Filières"},{to:"/niveaux",prefix:"/niveaux",label:"Niveaux"},{to:"/emplois",prefix:"/emplois",label:"Emplois du temps"}]},{key:"ecole-communautes",label:"Communautés",icon:"building",roles:[x.ADMIN_GENERALE,x.ADMIN_ECOLE],children:[{to:"/communautes/etudiants",prefix:"/communautes/etudiants",label:"Élèves"},{to:"/communautes/professeurs",prefix:"/communautes/professeurs",label:"Professeurs"}]}]},{title:"Pédagogie",items:[{key:"pedago",label:"Pédagogie",icon:"book",roles:[x.ADMIN_GENERALE,x.ADMIN_ECOLE,x.PROFESSEUR],children:[{to:"/cours",prefix:"/cours",label:"Cours"},{to:"/devoirs",prefix:"/devoirs",label:"Devoirs"},{to:"/interros",prefix:"/interros",label:"Interrogations"},{to:"/examens",prefix:"/examens",label:"Examens"},{to:"/notes",prefix:"/notes",label:"Saisie des notes"},{to:"/bulletins",prefix:"/bulletins",label:"Bulletins"}]}]},{title:"Rapports",items:[{key:"reports",label:"Rapports & Stats",icon:"chart",roles:[x.ADMIN_GENERALE,x.ADMIN_ECOLE],children:[{to:"/rapports/academiques",prefix:"/rapports/academiques",label:"Académiques"},{to:"/rapports/presences",prefix:"/rapports/presences",label:"Présences"}]}]}],r=C(()=>{const e=b.value;return u.map(p=>({...p,items:p.items.filter(l=>h(l.roles,e))})).filter(p=>p.items.length>0)}),f=U({}),$=C(()=>{const e={};return u.forEach(o=>o.items.forEach(p=>{p.key&&(e[p.key]=p)})),e});function _(e){return e.children?.some(o=>M(o.prefix))}function k(e){if(e in f)return;const o=$.value[e];f[e]=!!(o?.children&&_(o))}function A(e){return k(e),!!f[e]}function D(e){k(e),f[e]=!f[e]}W(()=>i.path,()=>{Object.keys($.value).forEach(e=>{const o=$.value[e];f[e]=!!(o?.children&&_(o))})},{immediate:!0});function M(e){return!!e&&(i.path===e||i.path.startsWith(e+"/"))}function n(e){const o={shield:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l8 4v6c0 5-3.5 9.74-8 10-4.5-.26-8-5-8-10V6l8-4z"/></svg>',building:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 21h18V3H3v18zm2-2V5h14v14H5zM7 7h4v4H7V7z"/></svg>',user:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5zm0 2c-4 0-8 2-8 6v2h16v-2c0-4-4-6-8-6z"/></svg>',layers:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3 1 9l11 6 11-6-11-6zm0 9L1 18l11 6 11-6-11-6z"/></svg>',book:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12V2zM6 4h10v14H6a2 2 0 0 0-2 2V4z"/></svg>',chart:'<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 3h2v18H3zM8 13h2v8H8zM13 9h2v12h-2zM18 5h2v16h-2z"/></svg>'};return o[e]??o.layers}return(e,o)=>(d(),c("div",ae,[t("div",ie,[v(N(L),{to:"/",class:"flex items-center gap-2 text-lg font-semibold"},{default:g(()=>[...o[2]||(o[2]=[t("svg",{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 3l9 8h-3v10H6V11H3l9-8z"})],-1),t("span",null,"Edulink",-1)])]),_:1})]),t("nav",de,[(d(!0),c(z,null,I(r.value,p=>(d(),c("div",{key:p.title,class:"space-y-2 mb-4"},[t("div",ue,y(p.title),1),(d(!0),c(z,null,I(p.items,l=>(d(),c("div",{key:l.key??l.to,class:"space-y-1"},[l.children?.length?(d(),c(z,{key:0},[t("button",{type:"button",onClick:w=>D(l.key),"aria-expanded":A(l.key)?"true":"false","aria-controls":`group-${l.key}`,class:S(["w-full flex items-center justify-between px-4 h-12 rounded-2xl text-[15px] font-semibold transition-colors bg-violet-50 text-violet-700 hover:bg-violet-100 dark:bg-violet-900/30 dark:text-violet-200 dark:hover:bg-violet-900/50",_(l)?"ring-1 ring-violet-300/60 dark:ring-violet-400/30":""])},[t("span",fe,[t("span",{class:"h-5 w-5",innerHTML:n(l.icon)},null,8,pe),t("span",null,y(l.label),1)]),(d(),c("svg",{class:S(["h-5 w-5 transition-transform",{"rotate-180":A(l.key)}]),viewBox:"0 0 20 20",fill:"currentColor"},[...o[3]||(o[3]=[t("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 0 1 1.06.02L10 10.17l3.71-2.94a.75.75 0 1 1 .94 1.16l-4.24 3.36a.75.75 0 0 1-.94 0L5.21 8.39a.75.75 0 0 1 .02-1.18z","clip-rule":"evenodd"},null,-1)])],2))],10,ce),v(O,{name:"fade"},{default:g(()=>[J(t("ul",{id:`group-${l.key}`,class:"pl-6 pt-2 space-y-2"},[(d(!0),c(z,null,I(l.children,w=>(d(),c("li",{key:w.to},[v(N(L),{to:w.to,class:S(["block px-4 py-2 text-[15px] rounded-md text-slate-600 hover:text-violet-700 hover:bg-slate-100 dark:text-slate-300 dark:hover:text-violet-200 dark:hover:bg-white/5",M(w.prefix)?"text-violet-700 font-semibold dark:text-violet-200":""]),onClick:o[0]||(o[0]=Fe=>e.$emit("navigate"))},{default:g(()=>[E(y(w.label),1)]),_:2},1032,["to","class"])]))),128))],8,ve),[[Q,A(l.key)]])]),_:2},1024)],64)):(d(),q(N(L),{key:1,to:l.to,class:S(["w-full flex items-center justify-between px-4 h-12 rounded-2xl text-[15px] font-semibold transition-colors bg-violet-50 text-violet-700 hover:bg-violet-100 dark:bg-violet-900/30 dark:text-violet-200 dark:hover:bg-violet-900/50",M(l.prefix)?"ring-1 ring-violet-300/60 dark:ring-violet-400/30":""]),onClick:o[1]||(o[1]=w=>e.$emit("navigate"))},{default:g(()=>[t("span",ge,[t("span",{class:"h-5 w-5",innerHTML:n(l.icon)},null,8,me),t("span",null,y(l.label),1)]),o[4]||(o[4]=t("svg",{class:"h-5 w-5 opacity-60",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M7.22 14.28a.75.75 0 0 1 0-1.06L10.44 10 7.22 6.78a.75.75 0 1 1 1.06-1.06l3.5 3.5a.75.75 0 0 1 0 1.06l-3.5 3.5a.75.75 0 0 1-1.06 0z","clip-rule":"evenodd"})],-1))]),_:2},1032,["to","class"]))]))),128))]))),128))])]))}},T=V(he,[["__scopeId","data-v-3aa27ac6"]]),be=["onKeydown"],xe=["aria-expanded"],ye=["onKeydown"],_e={class:"rounded-md border border-gray-200 bg-white py-1 shadow-lg ring-1 ring-black/5 dark:border-gray-700 dark:bg-gray-800"},ke={__name:"Dropdown",props:{align:{type:String,default:"right"},closeOnItemClick:{type:Boolean,default:!0}},emits:["open-change"],setup(m,{emit:i}){const a=m,b=i,s=B(!1),h=B(null),u=B(null);function r(){s.value=!s.value,$()}function f(){s.value&&(s.value=!1,b("open-change",!1))}function $(){b("open-change",s.value),s.value&&Z(A)}function _(n){h.value&&(h.value.contains(n.target)||f())}function k(){const n=u.value?.querySelectorAll("[data-dropdown-item]");return n?Array.from(n):[]}function A(){k()[0]?.focus()}function D(){const n=k();if(!n.length)return;const e=n.findIndex(o=>o===document.activeElement);n[(e+1)%n.length]?.focus()}function M(){const n=k();if(!n.length)return;const e=n.findIndex(o=>o===document.activeElement);n[(e-1+n.length)%n.length]?.focus()}return ee("dropdownClose",()=>{a.closeOnItemClick&&f()}),G(()=>document.addEventListener("click",_)),X(()=>document.removeEventListener("click",_)),(n,e)=>(d(),c("div",{class:"relative inline-block text-left",ref_key:"root",ref:h,onKeydown:R(H(f,["stop","prevent"]),["esc"])},[t("div",{onClick:r,"aria-haspopup":"menu","aria-expanded":s.value.toString()},[j(n.$slots,"trigger",{open:s.value,toggle:r},void 0,!0)],8,xe),v(O,{name:"fade-scale"},{default:g(()=>[s.value?(d(),c("div",{key:0,ref_key:"menu",ref:u,class:S(["absolute z-50 mt-2 min-w-[12rem]",m.align==="left"?"left-0":"right-0"]),role:"menu","aria-orientation":"vertical",onKeydown:[R(H(D,["prevent"]),["down"]),R(H(M,["prevent"]),["up"])]},[t("div",_e,[j(n.$slots,"default",{},void 0,!0)])],42,ye)):K("",!0)]),_:3})],40,be))}},we=V(ke,[["__scopeId","data-v-8677d102"]]),P={__name:"DropdownItem",props:{as:{type:[String,Object],default:"button"},to:{type:[String,Object],default:null},href:{type:String,default:null},close:{type:Boolean,default:!0}},emits:["select"],setup(m,{emit:i}){const a=m,b=i,s=te("dropdownClose",null),h=C(()=>a.as==="a"&&a.href?{href:a.href}:a.to?{to:a.to}:{type:"button"});function u(r){b("select",r),a.close&&s&&s()}return(r,f)=>(d(),q(se(m.as),oe(h.value,{class:"flex w-full items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 focus:bg-gray-100 focus:outline-none dark:text-gray-200 dark:hover:bg-gray-700 dark:focus:bg-gray-700",role:"menuitem","data-dropdown-item":"",onClick:u}),{default:g(()=>[j(r.$slots,"default")]),_:3},16))}},Ce={class:"h-16 sticky top-0 z-30 flex items-center justify-between gap-3 border-b border-gray-200 bg-white px-4 dark:border-gray-800 dark:bg-gray-900"},Ee={class:"flex items-center gap-2"},$e={class:"flex items-center gap-2"},Ae=["aria-expanded"],Me={class:"hidden sm:inline"},Se={class:"h-6 w-6 rounded-full bg-indigo-500 inline-flex items-center justify-center text-white text-xs"},ze={__name:"Navbar",setup(m){const i=re(),a=F(),b=C(()=>a.user??{name:"Admin"}),s=C(()=>(b.value.name||"A").split(" ").map(u=>u[0]).join("").slice(0,2).toUpperCase());function h(){a.logout(),i.replace({name:"login"})}return(u,r)=>(d(),c("header",Ce,[t("div",Ee,[t("button",{class:"md:hidden inline-flex h-9 w-9 items-center justify-center rounded-md border border-gray-300 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:border-gray-700 dark:hover:bg-gray-800 dark:focus:ring-indigo-400",onClick:r[0]||(r[0]=f=>u.$emit("toggle-sidebar")),"aria-label":"Ouvrir le menu"},[...r[1]||(r[1]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M4 6h16v2H4v-2zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"})],-1)])]),v(N(L),{to:"/",class:"md:hidden text-sm font-semibold"},{default:g(()=>[...r[2]||(r[2]=[E("Edulink",-1)])]),_:1})]),t("div",$e,[v(we,{align:"right"},{trigger:g(({open:f})=>[t("button",{class:"inline-flex items-center gap-2 rounded-md border border-gray-300 px-3 py-1.5 text-sm hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:border-gray-700 dark:hover:bg-gray-800 dark:focus:ring-indigo-400","aria-expanded":f.toString()},[t("span",Me,y(b.value.name),1),t("span",Se,y(s.value),1),r[3]||(r[3]=t("svg",{class:"h-4 w-4 opacity-70",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M7 10l5 5 5-5z"})],-1))],8,Ae)]),default:g(()=>[v(P,{as:"RouterLink",to:"/dashboard"},{default:g(()=>[...r[4]||(r[4]=[E("Dashboard",-1)])]),_:1}),r[6]||(r[6]=t("div",{class:"my-1 border-t border-gray-200 dark:border-gray-700"},null,-1)),v(P,{onSelect:h},{default:g(()=>[...r[5]||(r[5]=[E("Déconnexion",-1)])]),_:1})]),_:1})])]))}},Ne={class:"w-full border-t border-gray-200 bg-white px-4 py-3 text-xs text-gray-500 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-400"},Le={class:"flex flex-col sm:flex-row items-center justify-between gap-2"},Be={class:"font-semibold"},De={__name:"AppFooter",props:{appName:{type:String,default:"Edulink"},version:{type:String,default:"1.0"}},setup(m){return(i,a)=>(d(),c("footer",Ne,[t("div",Le,[t("p",null,[E(" © "+y(new Date().getFullYear())+" ",1),t("span",Be,y(m.appName),1),a[0]||(a[0]=E(". Tous droits réservés. ",-1))]),t("p",null," v"+y(m.version),1)])]))}},Ie={class:"min-h-screen w-full bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100"},Re={class:"flex"},He={class:"hidden md:block w-72 h-screen overflow-y-auto border-r border-slate-200 dark:border-slate-800"},je={key:0,class:"fixed inset-0 z-40 md:hidden flex"},Oe={class:"w-72 h-screen overflow-y-auto bg-white dark:bg-slate-950 border-r border-slate-200 dark:border-slate-800"},Ve={class:"flex-1 min-h-screen flex flex-col"},Te={class:"flex-1 p-4 md:p-6"},Pe={__name:"AppLayout",setup(m){const i=B(!1),a=le();return G(()=>{a.init().catch(console.error)}),(b,s)=>{const h=ne("RouterView");return d(),c("div",Ie,[t("div",Re,[t("aside",He,[v(T,{onNavigate:s[0]||(s[0]=u=>i.value=!1)})]),v(O,{name:"fade"},{default:g(()=>[i.value?(d(),c("div",je,[t("div",Oe,[v(T,{onNavigate:s[1]||(s[1]=u=>i.value=!1)})]),t("div",{class:"flex-1 bg-black/40",onClick:s[2]||(s[2]=u=>i.value=!1)})])):K("",!0)]),_:1}),t("div",Ve,[v(ze,{onToggleSidebar:s[3]||(s[3]=u=>i.value=!i.value)}),t("main",Te,[v(h)]),v(De,{class:"mt-auto",appName:"Edulink",version:"1.0"})])])])}}},Ue=V(Pe,[["__scopeId","data-v-5ad39d0e"]]);export{Ue as default};
