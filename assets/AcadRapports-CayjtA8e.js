import{m as y,c as u,a as o,b as t,t as i,x as h,F as m,h as p,k as x,J as g,f as k,o as r}from"./index-C5nwF8dZ.js";import{u as M}from"./school-CTfOjOI2.js";const w={class:"space-y-4"},I={class:"grid gap-4 md:grid-cols-2"},N={class:"rounded-xl border p-4 bg-white dark:bg-slate-900 dark:border-slate-800"},F={class:"font-semibold mb-2"},S={class:"space-y-1 text-sm"},B={class:"font-semibold"},V={key:0,class:"text-slate-500"},j={class:"rounded-xl border p-4 bg-white dark:bg-slate-900 dark:border-slate-800"},A={class:"font-semibold mb-2"},C={class:"space-y-1 text-sm"},D={class:"font-semibold"},E={key:0,class:"text-slate-500"},P={class:"flex gap-2 items-center"},R=["value"],U={__name:"AcadRapports",setup(q){const n=M(),d=y(n.periodes.find(a=>a.active)?.id??n.periodes[0]?.id??0),b=u(()=>n.getPeriode(d.value));function _(a){const e=a.reduce((l,c)=>l+Number(c.coef||0),0);return e?a.reduce((l,c)=>l+Number(c.note||0)*Number(c.coef||0),0)/e:null}const f=u(()=>n.classes.map(a=>{const e=n.students.filter(l=>l.classeId===a.id).map(l=>l.id),s=n.evaluations.filter(l=>e.includes(l.eleveId)&&l.periodeId===d.value);return{id:a.id,classe:a.libelle||a.label||a.code,moy:_(s)}})),v=u(()=>{const a=new Map;return n.evaluations.filter(e=>e.periodeId===d.value).forEach(e=>{a.has(e.matiere)||a.set(e.matiere,[]),a.get(e.matiere).push(e)}),Array.from(a.entries()).map(([e,s])=>({matiere:e,moy:_(s)}))});return(a,e)=>(r(),o("section",w,[e[2]||(e[2]=t("header",null,[t("h1",{class:"text-xl font-semibold"},"Rapports académiques"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Moyennes par classe et matière")],-1)),t("div",I,[t("div",N,[t("h3",F,"Moyenne par classe ("+i(b.value?.label||"—")+")",1),t("ul",S,[(r(!0),o(m,null,p(f.value,s=>(r(),o("li",{key:s.id,class:"flex items-center justify-between"},[t("span",null,i(s.classe),1),t("span",B,i(s.moy?.toFixed(2)??"—"),1)]))),128)),f.value.length?h("",!0):(r(),o("li",V,"—"))])]),t("div",j,[t("h3",A,"Moyenne par matière ("+i(b.value?.label||"—")+")",1),t("ul",C,[(r(!0),o(m,null,p(v.value,s=>(r(),o("li",{key:s.matiere,class:"flex items-center justify-between"},[t("span",null,i(s.matiere),1),t("span",D,i(s.moy?.toFixed(2)??"—"),1)]))),128)),v.value.length?h("",!0):(r(),o("li",E,"—"))])])]),t("div",P,[e[1]||(e[1]=t("label",{class:"text-sm text-slate-500"},"Période:",-1)),x(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),class:"px-3 py-2 rounded border dark:bg-slate-900"},[(r(!0),o(m,null,p(k(n).periodes,s=>(r(),o("option",{key:s.id,value:s.id},i(s.label),9,R))),128))],512),[[g,d.value,void 0,{number:!0}]])])]))}};export{U as default};
