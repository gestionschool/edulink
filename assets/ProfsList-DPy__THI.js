import{m as u,p as q,c as _,a,b as e,x as M,d as N,k as B,j as n,J as p,O as C,F as V,h as $,f as E,t as o,e as k,o as d,n as I,g as z,z as D}from"./index-DNOX9g9Q.js";import{M as F}from"./Modal-CesLprg6.js";import{u as H}from"./useTeachers-CqgeM82D.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"space-y-6"},G={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},K={class:"flex flex-wrap gap-2"},Q={class:"grid gap-3 md:grid-cols-3"},W=["value"],X={key:0,class:"rounded-xl border border-slate-200 p-4 text-sm text-slate-500 dark:border-slate-800 dark:text-slate-400"},Y={key:1,class:"rounded-xl border border-slate-200 p-4 text-sm text-slate-500 dark:border-slate-800 dark:text-slate-400"},Z={key:2,class:"md:hidden divide-y divide-slate-100 dark:divide-slate-800 rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900"},ee={class:"flex items-center justify-between"},te={class:"min-w-0"},se={class:"truncate text-sm font-medium"},le={class:"text-xs text-slate-500 dark:text-slate-400"},re={class:"mt-1 text-xs text-slate-500 dark:text-slate-400"},ae={class:"mt-2 flex justify-end"},oe=["onClick"],de={key:3,class:"hidden md:block overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900"},ie={class:"overflow-x-auto"},ne={class:"min-w-full text-left text-sm"},ue={class:"px-4 py-3"},me={class:"px-4 py-3"},be={class:"px-4 py-3"},xe={class:"px-4 py-3"},ve={class:"px-4 py-3"},pe={class:"flex justify-end gap-2"},ce=["onClick"],fe={class:"border-t border-slate-100 px-4 py-3 text-sm text-slate-500 dark:border-slate-800 dark:text-slate-400"},ge={class:"grid gap-3 md:grid-cols-2"},ke={class:"grid gap-3 md:grid-cols-2"},ye={key:0,class:"text-sm text-red-600 dark:text-red-400"},he=["disabled"],we=["disabled"],Ae={__name:"ProfsList",setup(_e){const i=H(),y=u(""),c=u(""),f=u(""),x=u(!1),g=u(!1),v=u(null),l=u({nom:"",prenom:"",email:"",matiere:"",statut:"Actif"});q(async()=>{await i.fetch()});const O=_(()=>Array.from(new Set((i.items||[]).map(r=>r.matiere).filter(Boolean))).sort()),m=_(()=>{const r=y.value.trim().toLowerCase();return(i.items||[]).filter(t=>c.value&&t.matiere!==c.value||f.value&&t.statut!==f.value?!1:r?`${t.nom||""} ${t.prenom||""} ${t.email||""}`.toLowerCase().includes(r):!0)}),R=_(()=>i.items?.length||0),U=r=>[r.prenom,r.nom].filter(Boolean).join(" ")||r.nom||"—";function A(r){const t="inline-flex items-center rounded-md px-2 py-0.5 text-xs font-medium";return r==="Actif"?`${t} bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-200`:r==="Inactif"?`${t} bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-200`:`${t} bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-200`}async function j(){if(v.value=null,!l.value.nom||!l.value.email){v.value="Nom et email sont obligatoires.";return}g.value=!0;try{await i.createOne({nom:l.value.nom,prenom:l.value.prenom||"",email:l.value.email,matiere:l.value.matiere||"",statut:l.value.statut||"Actif"}),await i.fetch(),x.value=!1,l.value={nom:"",prenom:"",email:"",matiere:"",statut:"Actif"}}catch(r){v.value=r?.message||"Erreur lors de la création"}finally{g.value=!1}}async function S(r){confirm("Supprimer ce professeur ?")&&(await i.removeOne(r),await i.fetch())}function T(){window.print()}function P(){const r=["id","nom","prenom","email","matiere","statut"],t=m.value.map(b=>[b.id,`"${b.nom||""}"`,`"${b.prenom||""}"`,`"${b.email||""}"`,`"${b.matiere||""}"`,`"${b.statut||""}"`].join(",")),s=[r.join(","),...t].join(`
`),h=new Blob([s],{type:"text/csv;charset=utf-8;"}),L=URL.createObjectURL(h),w=document.createElement("a");w.href=L,w.download="professeurs.csv",w.click(),URL.revokeObjectURL(L)}return(r,t)=>(d(),a("div",J,[e("div",G,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-xl font-semibold"},"Professeurs"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Liste des professeurs. Filtre par matière et statut. Export CSV. ")],-1)),e("div",K,[e("button",{type:"button",class:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm font-medium shadow-sm hover:bg-slate-50 dark:border-slate-800 dark:bg-slate-900",onClick:T}," Imprimer "),e("button",{type:"button",class:"inline-flex items-center gap-2 rounded-lg border border-violet-200 bg-violet-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-violet-700 dark:border-violet-900",onClick:P}," Export CSV "),e("button",{type:"button",class:"inline-flex items-center gap-2 rounded-lg border border-violet-200 bg-violet-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-violet-700 dark:border-violet-900",onClick:t[0]||(t[0]=s=>x.value=!0)},[...t[11]||(t[11]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"})],-1),B(" Nouveau professeur ",-1)])])])]),e("div",Q,[n(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),type:"search",placeholder:"Rechercher (nom, email)…",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},null,512),[[p,y.value]]),n(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>c.value=s),class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},[t[13]||(t[13]=e("option",{value:""},"Toutes matières",-1)),(d(!0),a(V,null,$(O.value,s=>(d(),a("option",{key:s,value:s},o(s),9,W))),128))],512),[[C,c.value]]),n(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},[...t[14]||(t[14]=[e("option",{value:""},"Tous statuts",-1),e("option",{value:"Actif"},"Actif",-1),e("option",{value:"Inactif"},"Inactif",-1)])],512),[[C,f.value]])]),E(i).loading?(d(),a("div",X," Chargement… ")):m.value.length===0?(d(),a("div",Y," Aucun professeur trouvé. ")):(d(),a("div",Z,[(d(!0),a(V,null,$(m.value,s=>(d(),a("div",{key:s.id,class:"p-3"},[e("div",ee,[e("div",te,[e("div",se,o(U(s)),1),e("div",le,o(s.email),1)]),e("span",{class:I(A(s.statut))},o(s.statut||"—"),3)]),e("div",re,o(s.matiere||"—"),1),e("div",ae,[e("button",{class:"rounded-md border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:border-red-900/40 dark:hover:bg-red-900/20",onClick:h=>S(s.id)}," Supprimer ",8,oe)])]))),128))])),m.value.length?(d(),a("div",de,[e("div",ie,[e("table",ne,[t[16]||(t[16]=e("thead",{class:"bg-slate-50 text-slate-600 dark:bg-slate-800 dark:text-slate-300"},[e("tr",null,[e("th",{class:"px-4 py-3 font-medium"},"Nom"),e("th",{class:"px-4 py-3 font-medium"},"Email"),e("th",{class:"px-4 py-3 font-medium"},"Matière"),e("th",{class:"px-4 py-3 font-medium"},"Statut"),e("th",{class:"px-4 py-3 font-medium text-right"},"Actions")])],-1)),e("tbody",null,[(d(!0),a(V,null,$(m.value,s=>(d(),a("tr",{key:s.id,class:"border-t border-slate-100 hover:bg-slate-50 dark:border-slate-800 dark:hover:bg-slate-800/60"},[e("td",ue,o(U(s)),1),e("td",me,o(s.email),1),e("td",be,o(s.matiere||"—"),1),e("td",xe,[e("span",{class:I(A(s.statut))},o(s.statut||"—"),3)]),e("td",ve,[e("div",pe,[N(E(z),{to:`/professeurs/detail?id=${s.id}`,class:"rounded-md border border-slate-200 px-2 py-1 text-xs hover:bg-slate-100 dark:border-slate-700 dark:hover:bg-slate-800"},{default:k(()=>[...t[15]||(t[15]=[B(" Détails ",-1)])]),_:1},8,["to"]),e("button",{class:"rounded-md border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:border-red-900/40 dark:hover:bg-red-900/20",onClick:h=>S(s.id)}," Supprimer ",8,ce)])])]))),128))])]),e("div",fe,o(m.value.length)+" / "+o(R.value)+" élément(s) ",1)])])):M("",!0),N(F,{modelValue:x.value,"onUpdate:modelValue":t[10]||(t[10]=s=>x.value=s)},{title:k(()=>[...t[17]||(t[17]=[e("h3",{class:"text-base font-semibold"},"Nouveau professeur",-1)])]),actions:k(()=>[e("button",{class:"inline-flex items-center rounded-md border border-slate-200 bg-white px-3 py-1.5 text-sm hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-900",onClick:t[9]||(t[9]=s=>x.value=!1),disabled:g.value},"Annuler",8,he),e("button",{class:"inline-flex items-center rounded-md border border-violet-200 bg-violet-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-violet-700 disabled:opacity-60 dark:border-violet-900",onClick:j,disabled:g.value},"Créer",8,we)]),default:k(()=>[e("form",{class:"space-y-3",onSubmit:D(j,["prevent"])},[e("div",ge,[e("div",null,[t[18]||(t[18]=e("label",{class:"mb-1 block text-xs text-slate-500 dark:text-slate-400"},"Nom",-1)),n(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.nom=s),type:"text",required:"",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-800 dark:bg-slate-900"},null,512),[[p,l.value.nom]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"mb-1 block text-xs text-slate-500 dark:text-slate-400"},"Prénom",-1)),n(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.prenom=s),type:"text",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-800 dark:bg-slate-900"},null,512),[[p,l.value.prenom]])])]),e("div",ke,[e("div",null,[t[20]||(t[20]=e("label",{class:"mb-1 block text-xs text-slate-500 dark:text-slate-400"},"Email",-1)),n(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.email=s),type:"email",required:"",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-800 dark:bg-slate-900"},null,512),[[p,l.value.email]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"mb-1 block text-xs text-slate-500 dark:text-slate-400"},"Matière",-1)),n(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.matiere=s),type:"text",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-800 dark:bg-slate-900"},null,512),[[p,l.value.matiere]])])]),e("div",null,[t[23]||(t[23]=e("label",{class:"mb-1 block text-xs text-slate-500 dark:text-slate-400"},"Statut",-1)),n(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.value.statut=s),class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm dark:border-slate-800 dark:bg-slate-900"},[...t[22]||(t[22]=[e("option",{value:"Actif"},"Actif",-1),e("option",{value:"Inactif"},"Inactif",-1)])],512),[[C,l.value.statut]])]),v.value?(d(),a("p",ye,o(v.value),1)):M("",!0)],32)]),_:1},8,["modelValue"])]))}};export{Ae as default};
