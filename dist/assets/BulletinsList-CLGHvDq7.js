import{m as k,c as x,a as o,b as t,x as y,k as _,J as g,F as m,h as v,f as h,o as a,t as d}from"./index-C5nwF8dZ.js";import{u as V}from"./school-CTfOjOI2.js";const w={class:"space-y-4"},C={class:"flex items-end gap-2 flex-wrap"},E=["value"],M=["value"],S={key:0,class:"overflow-x-auto rounded-xl border dark:border-slate-800"},F={class:"min-w-full text-sm"},I={class:"p-3"},D={class:"p-3"},L={class:"p-3"},U={key:0},j={__name:"BulletinsList",setup(A){const r=V(),u=k(0),i=k(r.periodes.find(l=>l.active)?.id??r.periodes[0]?.id??0),B=x(()=>r.students.filter(l=>l.classeId===u.value));function N(l,s){const e=r.getEvaluations(l,s),n=e.reduce((p,c)=>p+Number(c.coef||0),0);return n?e.reduce((p,c)=>p+Number(c.note||0)*Number(c.coef||0),0)/n:null}const b=x(()=>{const l=B.value.map(e=>{const n=N(e.id,i.value),f=r.getBulletinMeta(e.id,i.value);return{eleve:e,moyenne:n,rank:f.rank||null}});return[...l].filter(e=>e.moyenne!=null).sort((e,n)=>n.moyenne-e.moyenne).forEach((e,n)=>{e.rank||(e.rank=n+1)}),l});return(l,s)=>(a(),o("section",w,[t("header",C,[s[3]||(s[3]=t("div",null,[t("h1",{class:"text-xl font-semibold"},"Bulletins"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Moyennes par élève et période")],-1)),_(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),class:"px-3 py-2 rounded border dark:bg-slate-900"},[s[2]||(s[2]=t("option",{value:0,disabled:""},"— Classe —",-1)),(a(!0),o(m,null,v(h(r).classesView,e=>(a(),o("option",{key:e.id,value:e.id},d(e.libelle),9,E))),128))],512),[[g,u.value,void 0,{number:!0}]]),_(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),class:"px-3 py-2 rounded border dark:bg-slate-900"},[(a(!0),o(m,null,v(h(r).periodes,e=>(a(),o("option",{key:e.id,value:e.id},d(e.label),9,M))),128))],512),[[g,i.value,void 0,{number:!0}]])]),u.value?(a(),o("div",S,[t("table",F,[s[5]||(s[5]=t("thead",{class:"bg-slate-50 dark:bg-slate-900/50"},[t("tr",{class:"text-left"},[t("th",{class:"p-3"},"Élève"),t("th",{class:"p-3"},"Moyenne"),t("th",{class:"p-3"},"Rang")])],-1)),t("tbody",null,[(a(!0),o(m,null,v(b.value,e=>(a(),o("tr",{key:e.eleve.id,class:"border-t dark:border-slate-800"},[t("td",I,d(e.eleve.nom),1),t("td",D,d(e.moyenne?.toFixed(2)??"—"),1),t("td",L,d(e.rank??"—"),1)]))),128)),b.value.length?y("",!0):(a(),o("tr",U,[...s[4]||(s[4]=[t("td",{colspan:"3",class:"p-4 text-center text-slate-500"},"Aucun élève",-1)])]))])])])):y("",!0)]))}};export{j as default};
