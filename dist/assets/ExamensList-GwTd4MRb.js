import{m as K,r as C,f as y,c as i,o as r,i as k,h as V,b as Q,n as G,w as u,a as s,v as d,F as x,j as c,t as H,k as $,d as v}from"./index-BjUAzvaQ.js";import{u as I}from"./school-CHXg0hx7.js";import{_ as J}from"./PageHeader-DhanqyjH.js";import{_ as W,a as X}from"./CrudModal-Bs5nhJF3.js";import{_ as Y}from"./DataTable-C4q2Au5h.js";const Z={id:"cours-list"},_=["value"],h={id:"classe-list"},ee=["value"],le=["value"],se={class:"grid sm:grid-cols-2 gap-3"},de={__name:"ExamensList",setup(te){const{canEditPedago:f}=K(),p=I(),U=[{key:"titre",label:"Titre"},{key:"type",label:"Type"},{key:"date",label:"Date"},{key:"cours",label:"Cours"},{key:"classe",label:"Classe"},{key:"bareme",label:"Barème"},{key:"session",label:"Session"}],n=C({q:"",cours:"",classe:"",date:"",session:""}),q=y(()=>p.uniqueExamCours),g=y(()=>p.uniqueExamClasses),N=y(()=>p.uniqueExamSessions);function m(a){return String(a||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}const w=y(()=>{const a=m(n.value.q),e=m(n.value.cours),l=m(n.value.classe),E=n.value.date,S=n.value.session;return p.examens.filter(o=>{const L=m(`${o.titre} ${o.type} ${o.cours} ${o.classe} ${o.session} ${o.bareme}`),M=a?L.includes(a):!0,z=e?m(o.cours).includes(e):!0,P=l?m(o.classe).includes(l):!0,j=E?o.date===E:!0,A=S?o.session===S:!0;return M&&z&&P&&j&&A})}),b=C(!1),t=C({id:null,titre:"",type:"Final",date:"",cours:"",classe:"",bareme:20,session:"Normale"});function D(){f.value&&(t.value={id:null,titre:"",type:"Final",date:"",cours:"",classe:"",bareme:20,session:"Normale"},b.value=!0)}function F(a){f.value&&(t.value={...a},b.value=!0)}function T(){f.value&&(t.value.id?O():B(),b.value=!1)}function B(){p.addExamen({...t.value})}function O(){p.updateExamen({...t.value})}function R(a){f.value&&p.removeExamen(a.id)}function ne(){}return(a,e)=>(r(),i("div",null,[k(J,{title:"Examens"},{actions:V(()=>[G(f)?(r(),i("button",{key:0,class:"btn-primary",onClick:e[0]||(e[0]=l=>D())},"Nouveau")):Q("",!0)]),_:1}),k(W,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value=l),onReset:e[7]||(e[7]=l=>n.value={q:"",cours:"",classe:"",date:"",session:""})},{default:V(()=>[u(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>n.value.cours=l),class:"input",placeholder:"Cours…",list:"cours-list"},null,512),[[d,n.value.cours]]),s("datalist",Z,[(r(!0),i(x,null,c(q.value,l=>(r(),i("option",{key:l,value:l},null,8,_))),128))]),u(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>n.value.classe=l),class:"input",placeholder:"Classe…",list:"classe-list"},null,512),[[d,n.value.classe]]),s("datalist",h,[(r(!0),i(x,null,c(g.value,l=>(r(),i("option",{key:l,value:l},null,8,ee))),128))]),u(s("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>n.value.date=l),type:"date",class:"input"},null,512),[[d,n.value.date]]),u(s("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.session=l),class:"input"},[e[16]||(e[16]=s("option",{value:""},"Session",-1)),(r(!0),i(x,null,c(N.value,l=>(r(),i("option",{key:l,value:l},H(l),9,le))),128))],512),[[$,n.value.session]]),s("button",{class:"btn-outline",onClick:e[5]||(e[5]=l=>void 0)},"Filtrer")]),_:1},8,["modelValue"]),k(Y,{rows:w.value,headers:U,idKey:"id",onEdit:F,onRemove:R},null,8,["rows"]),k(X,{open:b.value,title:t.value.id?"Modifier examen":"Créer examen",onClose:e[15]||(e[15]=l=>b.value=!1),onSubmit:T},{default:V(()=>[s("div",se,[s("label",null,[e[17]||(e[17]=v("Titre ",-1)),u(s("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.titre=l),class:"input",required:""},null,512),[[d,t.value.titre]])]),s("label",null,[e[19]||(e[19]=v("Type ",-1)),u(s("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.type=l),class:"input"},[...e[18]||(e[18]=[s("option",null,"Final",-1),s("option",null,"Partiel",-1)])],512),[[$,t.value.type]])]),s("label",null,[e[20]||(e[20]=v("Date ",-1)),u(s("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.date=l),type:"date",class:"input",required:""},null,512),[[d,t.value.date]])]),s("label",null,[e[21]||(e[21]=v("Cours ",-1)),u(s("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.cours=l),class:"input",list:"cours-list",required:""},null,512),[[d,t.value.cours]])]),s("label",null,[e[22]||(e[22]=v("Classe ",-1)),u(s("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.classe=l),class:"input",list:"classe-list",required:""},null,512),[[d,t.value.classe]])]),s("label",null,[e[23]||(e[23]=v("Barème ",-1)),u(s("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.bareme=l),type:"number",class:"input",min:"1"},null,512),[[d,t.value.bareme,void 0,{number:!0}]])]),s("label",null,[e[25]||(e[25]=v("Session ",-1)),u(s("select",{"onUpdate:modelValue":e[14]||(e[14]=l=>t.value.session=l),class:"input"},[...e[24]||(e[24]=[s("option",null,"Normale",-1),s("option",null,"Rattrapage",-1)])],512),[[$,t.value.session]])])])]),_:1},8,["open","title"])]))}};export{de as default};
