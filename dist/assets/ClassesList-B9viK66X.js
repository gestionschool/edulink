import{a as d,o as i,b as e,x as T,t as a,s as h,k as g,d as m,e as f,f as p,g as w,F as x,h as b,m as _,p as V,c as v,j as $,J as j,O as S,i as q}from"./index-BVVU7ImF.js";import{u as A}from"./useClasses-6cjNtIyF.js";const L={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},F={class:"text-xl font-semibold"},O={key:0,class:"text-sm text-slate-500 dark:text-slate-400"},R={class:"flex flex-wrap gap-2"},D={__name:"PageHeader",props:{title:{type:String,required:!0},subtitle:{type:String,default:""}},setup(l){return(t,n)=>(i(),d("header",L,[e("div",null,[e("h1",F,a(l.title),1),l.subtitle?(i(),d("p",O,a(l.subtitle),1)):T("",!0)]),e("div",R,[h(t.$slots,"actions")])]))}},M={class:"grid grid-cols-1 gap-3 sm:grid-cols-2 lg:grid-cols-3"},U={__name:"Toolbar",setup(l){return(t,n)=>(i(),d("div",M,[h(t.$slots,"default")]))}},E={key:0,class:"p-6"},H={key:1,class:"p-6 text-sm text-red-600 dark:text-red-400"},z={key:2,class:"p-6 text-sm text-slate-500 dark:text-slate-400"},G={__name:"StateBlock",props:{loading:{type:Boolean,default:!1},error:{default:null},empty:{type:Boolean,default:!1},emptyText:{type:String,default:"Aucune donnée."}},setup(l){return(t,n)=>l.loading?(i(),d("div",E,[...n[0]||(n[0]=[e("div",{class:"mb-3 h-4 w-1/3 animate-pulse rounded bg-slate-200 dark:bg-slate-800"},null,-1),e("div",{class:"mb-2 h-4 w-full animate-pulse rounded bg-slate-200 dark:bg-slate-800"},null,-1),e("div",{class:"h-4 w-5/6 animate-pulse rounded bg-slate-200 dark:bg-slate-800"},null,-1)])])):l.error?(i(),d("div",H,a(l.error),1)):l.empty?(i(),d("div",z,a(l.emptyText),1)):h(t.$slots,"default",{key:3})}},J={class:"p-4"},P={class:"flex items-start justify-between gap-3"},I={class:"min-w-0"},K={class:"flex items-center gap-2"},Q={class:"inline-flex h-6 w-6 items-center justify-center rounded-md bg-slate-100 text-xs font-semibold text-slate-700 dark:bg-slate-800 dark:text-slate-200"},W={class:"truncate text-sm font-semibold"},X={class:"mt-1 line-clamp-2 text-xs text-slate-500 dark:text-slate-400"},Y={class:"mt-0.5 text-xs text-slate-500 dark:text-slate-400"},Z={class:"font-medium text-slate-700 dark:text-slate-200"},ee={class:"shrink-0 space-x-2"},te={__name:"ClassCard",props:{item:{type:Object,required:!0}},emits:["remove"],setup(l,{emit:t}){const n=t;return(u,r)=>(i(),d("li",J,[e("div",P,[e("div",I,[e("div",K,[e("span",Q,a(l.item.code),1),e("h3",W,a(l.item.libelle||l.item.label),1)]),e("p",X," Niveau "+a(l.item.niveau)+" • "+a(l.item.filiere)+" • "+a(l.item.effectif??0)+" élèves ",1),e("p",Y,[r[1]||(r[1]=g(" Titulaire : ",-1)),e("span",Z,a(l.item.titulaire||"—"),1)])]),e("div",ee,[m(p(w),{to:{path:"/classes/detail",query:{id:l.item.id}},class:"inline-flex items-center rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-100 dark:border-slate-700 dark:hover:bg-slate-800"},{default:f(()=>[...r[2]||(r[2]=[g("Détails",-1)])]),_:1},8,["to"]),e("button",{type:"button",class:"inline-flex items-center rounded-lg border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:border-red-900/40 dark:hover:bg-red-900/20",onClick:r[0]||(r[0]=y=>n("remove",l.item.id))},"Supprimer")])])]))}},se={class:"overflow-x-auto"},le={class:"min-w-full text-left text-sm"},re={class:"px-4 py-3"},ae={class:"px-4 py-3"},oe={class:"px-4 py-3"},ie={class:"px-4 py-3"},de={class:"px-4 py-3"},ne={class:"px-4 py-3"},ue={class:"px-4 py-3"},ce={class:"flex justify-end gap-2"},me=["onClick"],fe={class:"flex items-center justify-between border-t border-slate-100 px-4 py-3 text-sm dark:border-slate-800"},pe={class:"text-slate-500 dark:text-slate-400"},ve={__name:"ClassTable",props:{items:{type:Array,default:()=>[]},total:{type:Number,default:0}},emits:["remove"],setup(l){const t=l;return(n,u)=>(i(),d("div",se,[e("table",le,[u[1]||(u[1]=e("thead",{class:"bg-slate-50 text-slate-600 dark:bg-slate-800 dark:text-slate-300"},[e("tr",null,[e("th",{class:"px-4 py-3 font-medium"},"Code"),e("th",{class:"px-4 py-3 font-medium"},"Libellé"),e("th",{class:"px-4 py-3 font-medium"},"Niveau"),e("th",{class:"px-4 py-3 font-medium"},"Filière"),e("th",{class:"px-4 py-3 font-medium"},"Effectif"),e("th",{class:"px-4 py-3 font-medium"},"Titulaire"),e("th",{class:"px-4 py-3 font-medium text-right"},"Actions")])],-1)),e("tbody",null,[(i(!0),d(x,null,b(t.items,r=>(i(),d("tr",{key:r.id,class:"border-t border-slate-100 hover:bg-slate-50 dark:border-slate-800 dark:hover:bg-slate-800/60"},[e("td",re,a(r.code),1),e("td",ae,a(r.libelle||r.label),1),e("td",oe,a(r.niveau),1),e("td",ie,a(r.filiere),1),e("td",de,a(r.effectif??0),1),e("td",ne,a(r.titulaire||"—"),1),e("td",ue,[e("div",ce,[m(p(w),{to:`/classes/detail?id=${r.id}`,class:"rounded-lg border border-slate-200 px-2 py-1 text-xs hover:bg-slate-100 dark:border-slate-700 dark:hover:bg-slate-800"},{default:f(()=>[...u[0]||(u[0]=[g(" Détails ",-1)])]),_:1},8,["to"]),e("button",{class:"rounded-lg border border-red-200 px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:border-red-900/40 dark:hover:bg-red-900/20",onClick:y=>n.$emit("remove",r.id)}," Supprimer ",8,me)])])]))),128))])]),e("div",fe,[e("span",pe,a((t.items||[]).length)+" / "+a(t.total)+" éléments ",1),h(n.$slots,"pagination")])]))}},xe={class:"space-y-6"},be=["value"],ge=["value"],he={class:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm dark:border-slate-800 dark:bg-slate-900"},ye={class:"divide-y divide-slate-100 dark:divide-slate-800 md:hidden"},ke={class:"hidden md:block"},we={__name:"ClassesList",setup(l){const t=A(),n=_(""),u=_(""),r=_("");V(()=>{t.list?.()??t.fetch?.()});const y=v(()=>Array.from(new Set((t.items||[]).map(c=>c.niveau).filter(Boolean))).sort()),B=v(()=>Array.from(new Set((t.items||[]).map(c=>c.filiere).filter(Boolean))).sort()),k=v(()=>{const c=n.value.trim().toLowerCase();return(t.items||[]).filter(s=>u.value&&s.niveau!==u.value||r.value&&s.filiere!==r.value?!1:c?`${s.code} ${s.libelle||s.label} ${s.titulaire||""}`.toLowerCase().includes(c):!0)}),N=v(()=>t.items?.length||0);async function C(c){if(!confirm("Supprimer cette classe ?"))return;await(t.remove?.bind(t)||t.removeOne?.bind(t))(c),await(t.list?.()??t.fetch?.())}return(c,s)=>(i(),d("section",xe,[m(D,{title:"Classes",subtitle:"Gestion des classes (niveau, filière, titulaire, effectif)"},{actions:f(()=>[m(p(w),{to:"/classes/nouveau",class:"inline-flex items-center gap-2 rounded-lg border border-violet-200 bg-violet-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-violet-700 dark:border-violet-900"},{default:f(()=>[...s[3]||(s[3]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"})],-1),g(" Nouvelle classe ",-1)])]),_:1})]),_:1}),m(U,null,{default:f(()=>[s[6]||(s[6]=e("label",{class:"sr-only",for:"q"},"Recherche",-1)),$(e("input",{id:"q","onUpdate:modelValue":s[0]||(s[0]=o=>n.value=o),type:"search",placeholder:"Rechercher (code, libellé, titulaire)…",class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},null,512),[[j,n.value]]),s[7]||(s[7]=e("label",{class:"sr-only",for:"niv"},"Niveau",-1)),$(e("select",{id:"niv","onUpdate:modelValue":s[1]||(s[1]=o=>u.value=o),class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},[s[4]||(s[4]=e("option",{value:""},"Tous niveaux",-1)),(i(!0),d(x,null,b(y.value,o=>(i(),d("option",{key:o,value:o},a(o),9,be))),128))],512),[[S,u.value]]),s[8]||(s[8]=e("label",{class:"sr-only",for:"fil"},"Filière",-1)),$(e("select",{id:"fil","onUpdate:modelValue":s[2]||(s[2]=o=>r.value=o),class:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-violet-500 focus:ring-1 focus:ring-violet-500 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-100"},[s[5]||(s[5]=e("option",{value:""},"Toutes filières",-1)),(i(!0),d(x,null,b(B.value,o=>(i(),d("option",{key:o,value:o},a(o),9,ge))),128))],512),[[S,r.value]])]),_:1}),e("div",he,[m(G,{loading:p(t).loading,error:p(t).error?.message||p(t).error,empty:k.value.length===0,"empty-text":"Aucune classe trouvée."},{default:f(()=>[e("ul",ye,[(i(!0),d(x,null,b(k.value,o=>(i(),q(te,{key:"m-"+o.id,item:o,onRemove:C},null,8,["item"]))),128))]),e("div",ke,[m(ve,{items:k.value,total:N.value,onRemove:C},null,8,["items","total"])])]),_:1},8,["loading","error","empty"])])]))}};export{we as default};
